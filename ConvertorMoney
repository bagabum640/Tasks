using System;

namespace Task
{
    class Program
    {
        static void Main(string[] args)
        {
            double pesos;
            double doubloons;
            double golds;
            bool isExit = false;
            ConsoleKeyInfo key;
            float valuePeso = 1;
            float valueDoubloon = 73;
            float valueGold = 85;

            CreditToAccount(out pesos, 1000, 3000); //числа взяты просто для создания случайного баланса на счете
            CreditToAccount(out doubloons, 50, 150);
            CreditToAccount(out golds, 50, 150);

            while (isExit == false)
            {
                ShowBalance(pesos, doubloons, golds);
                Console.WriteLine("\nНажмите: " +
                    "\n1 на NumPad чтобы перейти к обмену валют песо-дублон " +
                    "\n2 на NumPad чтобы перейти к обмену валют песо-золотой " +
                    "\n3 на NumPad чтобы перейти к обмену валют дублон-золотой" +
                    "\n\nEscape чтобы покинуть обменный пункт\n");
                key = Console.ReadKey(true);

                switch (key.Key)
                {
                    case ConsoleKey.NumPad1:
                        Console.WriteLine("Ecли вы хотите обменять песо на дублоны нажмите D на клавиатуре, если дублоны в песо, то нажмите P" +
                            $"\nЦена 1 песо = {valuePeso} песо\t1 дублона = {valueDoubloon} песо");
                        key = Console.ReadKey(true);

                        switch (key.Key)
                        {
                            case ConsoleKey.D:
                                Convertor(ref pesos, ref doubloons, valuePeso, valueDoubloon);
                                break;
                            case ConsoleKey.P:
                                Convertor(ref doubloons, ref pesos, valueDoubloon, valuePeso);
                                break;
                            default:
                                Console.Clear();
                                break;
                        }
                        break;
                    case ConsoleKey.NumPad2:
                        Console.WriteLine("Ecли вы хотите обменять песо на золотые нажмите G на клавиатуре, если золотые на песо, то нажмите P" +
                            $"\nЦена 1 песо = {valuePeso} песо\t1 золотой = {valueGold} песо");
                        key = Console.ReadKey(true);

                        switch (key.Key)
                        {
                            case ConsoleKey.G:
                                Convertor(ref pesos, ref golds, valuePeso, valueGold);
                                break;
                            case ConsoleKey.P:
                                Convertor(ref golds, ref pesos, valueGold, valuePeso);
                                break;
                            default:
                                Console.Clear();
                                break;
                        }
                        break;
                    case ConsoleKey.NumPad3:
                        Console.WriteLine("Ecли вы хотите обменять дублоны на золотые нажмите G на клавиатуре, если золотые на дублоны, то нажмите D" +
                            $"\nЦена 1 дублон = {valueDoubloon} песо\t1 золотой = {valueGold} песо");
                        key = Console.ReadKey(true);

                        switch (key.Key)
                        {
                            case ConsoleKey.G:
                                Convertor(ref doubloons, ref golds, valueDoubloon, valueGold);
                                break;
                            case ConsoleKey.D:
                                Convertor(ref golds, ref doubloons, valueGold, valueDoubloon);
                                break;
                            default:
                                Console.Clear();
                                break;
                        }
                        break;
                    case ConsoleKey.Escape:
                        isExit = true;
                        break;
                    default:
                        Console.Clear();
                        break;
                }
            }
        }

        static void CreditToAccount(out double money, int minValue, int maxValue)
        {
            Random random = new Random();
            money = random.Next(minValue, maxValue);
        }

        static void ShowBalance(double pesos, double doubloons, double golds)
        {
            Console.WriteLine($"У вас на счете: \n{pesos} песо \n{doubloons} дублонов \n{golds} золотых \n ");
        }

        static void Convertor(ref double tradedСurrency, ref double purchasedСurrency, float valueOfTradedCurrency, float valueOfPurchasedCurrency)
        {
            ConsoleKeyInfo key;
            double quantity;

            key = Console.ReadKey(true);
            Console.WriteLine("Сколько монет вы хотите купить?");
            quantity = Math.Round(Convert.ToDouble(Console.ReadLine()), 2);
            Console.Clear();

            if (tradedСurrency >= quantity * valueOfPurchasedCurrency/ valueOfTradedCurrency)
            {
                purchasedСurrency += quantity;
                tradedСurrency -= Math.Round(quantity * valueOfPurchasedCurrency/ valueOfTradedCurrency, 2);
            }
            else
            {
                Console.ForegroundColor = ConsoleColor.Red;
                Console.WriteLine("Операция не может быть выполнена - недостаточно средств!\n\n\n");
                Console.ResetColor();
            }
        }
    }
}
